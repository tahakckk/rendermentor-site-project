@model RenderMentor.Models.ViewModels.OrderDetailsVM
@using RenderMentor.Utility

@{
    ViewData["Title"] = "Details";
    Layout = "~/Views/Shared/_Layout-admin.cshtml";
}

<div class="col-lg-10">
    <div class="row mb-4">
        <div class="col-md-6">
            <h1>Sipariş Detayı</h1>
            <ol class="breadcrumb breadcrumb-double-angle bg-transparent p-0">
                <li class="breadcrumb-item"><a asp-area="Base" asp-controller="Home" asp-action="Index">Anasayfa</a></li>
                <li class="breadcrumb-item"><a asp-area="Admin" asp-controller="Dashboard" asp-action="Index">Admin</a></li>
                <li class="breadcrumb-item"><a asp-area="Admin" asp-controller="Order" asp-action="Index">Siparişler</a></li>
                <li class="breadcrumb-item">Sipariş Detayı</li>
            </ol>
        </div>
        <div class="col-md-6">
            <div class="admin-top-actions d-flex justify-content-end">
                <div class="btn-group" role="group" aria-label="Basic example">
                    <a asp-action="Index" class="btn btn-info"><i class="fa fa-arrow-left"></i> Siparişlere Dön</a>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-6">
            <div class="card shadow-v1 padding-30">
                <form method="post" enctype="multipart/form-data">
                    <div class="border-bottom mb-4 pb-4">
                        <h4 class="mb-4">Sipariş Bilgileri</h4>
                        <div class="form-group row">
                            <label class="col-md-2 col-form-label text-dark font-weight-bold">
                                Sipariş No
                                <span class="d-inline-block" tabindex="-1" data-toggle="tooltip" title="Sipariş ile ilgili iptal, iade ve banka tarafındaki işlemlerin gerçekleştirilebileceği tanımayıcı numara.">
                                    <button class="btn btn-link btn-sm" style="pointer-events: none;" type="button" disabled><i class="fa fa-question-circle"></i></button>
                                </span>
                            </label>
                            <div class="col-md-10">
                                <input value="@Model.OrderHeader.OrderNumber" class="form-control" readonly>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-2 col-form-label text-dark font-weight-bold">
                                Sipariş Zamanı
                                <span class="d-inline-block" tabindex="-1" data-toggle="tooltip" title="Siparişin gerçekleştirildiği tarih ve saat.">
                                    <button class="btn btn-link btn-sm" style="pointer-events: none;" type="button" disabled><i class="fa fa-question-circle"></i></button>
                                </span>
                            </label>
                            <div class="col-md-10">
                                <input value="@Model.OrderHeader.OrderDate.ToShortDateString()" class="form-control" readonly>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-2 col-form-label text-dark font-weight-bold">
                                Sipariş Toplamı
                                <span class="d-inline-block" tabindex="-1" data-toggle="tooltip" title="Siparişin toplam fiyatını TL cinsinden belirtir.">
                                    <button class="btn btn-link btn-sm" style="pointer-events: none;" type="button" disabled><i class="fa fa-question-circle"></i></button>
                                </span>
                            </label>
                            <div class="col-md-10">
                                <input asp-for="OrderHeader.OrderTotal" class="form-control" value="@Model.OrderHeader.OrderTotal">
                                <span asp-validation-for="OrderHeader.OrderTotal" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-2 col-form-label text-dark font-weight-bold">
                                Sipariş Durumu
                                <span class="d-inline-block" tabindex="-1" data-toggle="tooltip" title="Siparişin hangi aşamada olduğunu bu alandan inceleyebilirsiniz. Durumu düzenlemek için sağ taraftaki sipariş özetinin altındaki Sipariş Durumu bölümünde yer alan butonu kullanınız.">
                                    <button class="btn btn-link btn-sm" style="pointer-events: none;" type="button" disabled><i class="fa fa-question-circle"></i></button>
                                </span>
                            </label>
                            <div class="col-md-10">
                                <input asp-for="OrderHeader.OrderStatus" class="form-control" value="@Model.OrderHeader.OrderStatus" readonly>
                                <span asp-validation-for="OrderHeader.OrderStatus" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-2 col-form-label text-dark font-weight-bold">
                                Sipariş Kodu
                                <span class="d-inline-block" tabindex="-1" data-toggle="tooltip" title="Siparişin Garanti Bankası tarafından oluşturulan sipariş kodu. Garanti panelindeki sipariş kodu ile aynıdır.">
                                    <button class="btn btn-link btn-sm" style="pointer-events: none;" type="button" disabled><i class="fa fa-question-circle"></i></button>
                                </span>
                            </label>
                            <div class="col-md-10">
                                <input asp-for="OrderHeader.TransactionId" class="form-control" value="@Model.OrderHeader.TransactionId" readonly>
                                <span asp-validation-for="OrderHeader.TransactionId" class="text-danger"></span>
                            </div>
                        </div>
                    </div>
                    <div class="border-bottom mb-4 pb-4">
                        <div asp-validation-summary="ModelOnly" class="text-danger"></div>
                        <input type="hidden" asp-for="OrderHeader.Id" />
                        <h4 class="mb-4">Müşteri Bilgileri</h4>
                        <div class="form-group row">
                            <label class="col-md-2 col-form-label text-dark font-weight-bold">
                                Müşteri Adı
                                <span class="d-inline-block" tabindex="-1" data-toggle="tooltip" title="Siparişi oluşturan müşterinin adı.">
                                    <button class="btn btn-link btn-sm" style="pointer-events: none;" type="button" disabled><i class="fa fa-question-circle"></i></button>
                                </span>
                            </label>
                            <div class="col-md-10">
                                <input asp-for="OrderHeader.Name" class="form-control" value="@Model.OrderHeader.Name" readonly>
                                <span asp-validation-for="OrderHeader.Name" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-2 col-form-label text-dark font-weight-bold">
                                E-Posta Adresi
                                <span class="d-inline-block" tabindex="-1" data-toggle="tooltip" title="Siparişi oluşturan müşterinin e-posta adresi.">
                                    <button class="btn btn-link btn-sm" style="pointer-events: none;" type="button" disabled><i class="fa fa-question-circle"></i></button>
                                </span>
                            </label>
                            <div class="col-md-10">
                                <input asp-for="OrderHeader.Email" class="form-control" value="@Model.OrderHeader.Email" readonly>
                                <span asp-validation-for="OrderHeader.Email" class="text-danger"></span>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-md-2 col-form-label text-dark font-weight-bold">
                                Telefon Numarası
                                <span class="d-inline-block" tabindex="-1" data-toggle="tooltip" title="Siparişi oluşturan müşterinin telefon numarası.">
                                    <button class="btn btn-link btn-sm" style="pointer-events: none;" type="button" disabled><i class="fa fa-question-circle"></i></button>
                                </span>
                            </label>
                            <div class="col-md-10">
                                <input asp-for="OrderHeader.PhoneNumber" class="form-control" value="@Model.OrderHeader.PhoneNumber" readonly>
                                <span asp-validation-for="OrderHeader.PhoneNumber" class="text-danger"></span>
                            </div>
                        </div>
                    </div>                    

                    <div class="my-5">
                        <button type="submit" class="icon-btn btn btn-success mr-2"><i class="fa fa-check-circle"></i> Kaydet</button>
                        <a asp-action="Index" class="icon-btn btn btn-info mr-2"><i class="fa fa-arrow-left"></i> Siparişlere Dön</a>
                    </div>
                </form>
            </div> <!-- END card-->
        </div>
        <div class="col-md-4">
            <h4 class="d-flex justify-content-between align-items-center my-3">
                <span>Sipariş Özeti</span>
                <span class="badge badge-primary badge-pill">@Model.OrderDetails.Count()</span>
            </h4>
            <ul class="list-group mb-3">
                @foreach (var details in Model.OrderDetails)
                {
                    <li class="list-group-item d-flex justify-content-between lh-condensed">
                        <div>
                            <input type="hidden" asp-for="@details.Id" />
                            <h6 class="my-0">@details.Course.Title</h6>
                        </div>
                        <span class="text-muted">@(String.Format("{0:C}",details.Course.Price))</span>
                    </li>
                }

                <li class="list-group-item d-flex justify-content-between">
                    <span>Toplam (TL)</span>
                    <strong>@(String.Format("{0:C}", Model.OrderHeader.OrderTotal))</strong>
                </li>
            </ul>
            <h4 class="d-flex justify-content-between align-items-center my-3">
                <span>Sipariş Durumu</span>
                <span class="text-info">@Model.OrderHeader.OrderStatus</span>
            </h4>
            @if (Model.OrderHeader.OrderStatus == SD.StatusApproved || Model.OrderHeader.OrderStatus == SD.StatusPending)
            {
                <a asp-action="StartProcessing" asp-route-id="@Model.OrderHeader.Id" class="btn btn-primary form-control">İşleme Al</a>

            }
            @if (Model.OrderHeader.OrderStatus == SD.StatusInProcess)
            {
                <a asp-action="ShipOrder" asp-route-id="@Model.OrderHeader.Id" class="btn btn-primary form-control">Siparişi Gönder</a>
            }
            @if (Model.OrderHeader.OrderStatus == SD.StatusShipped || Model.OrderHeader.OrderStatus == SD.StatusCancelled)
            {
                <label class="btn btn-primary form-control">@Model.OrderHeader.OrderStatus</label>
            }

            @if (Model.OrderHeader.OrderStatus != SD.StatusRefunded && Model.OrderHeader.OrderStatus != SD.StatusCancelled)
	        {
                <div class="pt-2">
                    <a asp-action="CancelOrder" asp-route-id="@Model.OrderHeader.Id" class="btn btn-danger form-control">İptal Et</a>
                </div>
	        }
        </div>
    </div>
</div> <!-- END col-md-8 -->

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}

